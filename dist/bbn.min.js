(function(global,factory){if(typeof exports==='object'&&typeof module!=='undefined'){module.exports=factory();}
else if(typeof define==='function'&&define.amd){define(factory);}
else{global.bbn=factory();global.exports=global;}}(this,()=>{"use strict";if(axios){axios.defaults.headers.post['Content-Type']='text/json';}
return{version:"1.0.1",opt:{_cat:{}},_(st){let res=bbn.lng[st]||st;let args=Array.prototype.slice.call(arguments,1);if(args.length){let i=0;return res.replace(/\%([d|s])/g,(match,type)=>{let tmp=args[i];i++;if(((type==='d')&&bbn.fn.isNumber(tmp))||((type==='s')&&bbn.fn.isString(tmp))){return tmp;}
return match;});}
return res;},$(selector,context){if(context&&context.querySelectorAll){return context.querySelectorAll(selector);}
return document.body.querySelectorAll(selector);},_popups:[],lng:{select_unselect_all:"Select/Clear all",select_all:"Select all",search:'Search',loading:'Loading...',choose:'Choose',error:'Error',server_response:'Server response',reload:'Reload',errorText:'Something went wrong',closeAll:"Close all",closeOthers:"Close others",pin:"Pin",arrange:"Arrange",cancel:"Cancel",unpin:"Unpin",yes:"Yes",no:"No",unknown:"Unknown",untitled:"Untitled",confirmation:"Confirmation",Today:"Today",Tomorrow:"Tomorrow",Yesterday:"Yesterday"},app:{popups:[],}};}));(()=>{"use strict";if('jQuery'in window){jQuery.fn.extend({bbn:function(fnName,params){var args=[];for(var i=0;i<arguments.length;i++){args.push(arguments[i]);}
if(bbn&&bbn.fn&&bbn.fn.isFunction(bbn.fn[fnName])){return this.each(function(){var args2=args.slice();args2.splice(0,1,jQuery(this));bbn.fn[fnName].apply(bbn,args2);});}}});if(jQuery.fn.reverse===undefined){jQuery.fn.reverse=[].reverse;}}})();;(function(){"use strict";bbn.env={siteTitle:window.document.title,logging:false,cdn:'',lang:'en',host:window.location.protocol+'//'+window.location.hostname,url:window.location.href,old_path:null,loading:false,width:0,height:0,focused:false,last_focus:(new Date()).getTime(),sleep:false,loaders:[],loadersHistory:[],maxLoadersHistory:20,resizeTimer:false,hashChanged:0,params:[],isInit:false,isFocused:false,timeoff:Math.round((new Date()).getTime()/ 1000),loggingLevel:5,ignoreUnload:false,historyDisabled:false,nav:'ajax'};})();;(function(bbn){"use strict";bbn.var={loggers:{_num:0},datatypes:['xml','html','script','json','jsonp','text','blob'],shortenLen:30,keys:{upDown:[33,34,35,36,38,40],leftRight:[36,35,37,39],dels:[8,46,45],confirm:[13,9],alt:[20,16,17,18,144],numbers:[48,49,50,51,52,53,54,55,56,57,96,97,98,99,100,101,102,103,104,105],numsigns:[109,110,189,190]},comparators:[">=","<=",">","<","="],operators:["+","-","/","*"],colors:{black:'#000000',anthracite:'#454545',orange:'#ff9900',red:'#db3340',green:'#00a03e',blue:'#6e9ecf',yellow:'#fdf200',beige:'#fdfdfd',white:'#ffffff',purple:'#a333c8',grey:'#d3d3d3',brown:'#8c6954',olive:'#92b06a',pink:'#eb65a0',turquoise:'#1fda9a',cyan:'#00c8f8',navy:'#354458',darkgrey:'#5a6a62',lightgrey:'#dcdcdc',teal:'#009688',indigo:'#3f51b5',palegreen:'#ccffcc',pastelgreen:'#E2EFDA',pastelorange:'#fff2cc',pastelblue:'#ddebf6',webblue:'#2196f3'},mockText:"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.",regexp:{url:new RegExp('^(https?:\\/\\/)?'+'((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.?)+[a-z]{2,}|'+'((\\d{1,3}\\.){3}\\d{1,3}))'+'(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*'+'(\\?[;&a-z\\d%_.~+=-]*)?'+'(\\#[-a-z\\d_]*)?$','i'),ip:new RegExp("^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$"),hostname:new RegExp("^[a-z\\d]([a-z\\d\\-]{0,61}[a-z\\d])?(\\.[a-z\\d]([a-z\\d\\-]{0,61}[a-z\\d])?)*$",'i'),}};})(bbn);;(function(bbn){"use strict";Object.assign(bbn.var,{})})(bbn);;((bbn)=>{"use strict";bbn.fn={defaultAjaxErrorFunction(jqXHR,textStatus,errorThrown){bbn.fn.log(textStatus,errorThrown);},defaultAjaxAbortFunction(message,url){bbn.fn.log(message);},defaultPreLinkFunction(url,ele){return true;},defaultErrorFunction(message){bbn.fn.log(message);},defaultLinkFunction(responseObj,ele){return true;},defaultPostLinkFunction(r){return true;},defaultStartLoadingFunction(url,data){return true;},defaultEndLoadingFunction(url,data,res){return true;},defaultHistoryFunction(obj){return true;},defaultResizeFunction(){return true;},defaultAlertFunction(text,title){alert(text);},defaultConfirmFunction(text,yesFn,noFn){let ok=0;if(confirm(text)){if(bbn.fn.isFunction(yesFn)){yesFn();ok=1;}}
if(!ok&&bbn.fn.isFunction(noFn)){noFn();}}};})(bbn);;((bbn)=>{"use strict";let _private={};Object.assign(bbn.fn,{ajax(url,datatype,data,success,failure,abort){if((arguments.length===1)&&bbn.fn.isObject(url)&&url.url){if(url.abort){abort=url.abort;}
if(url.failure){failure=url.failure;}
if(url.success){success=url.success;}
if(url.data){data=url.data;}
if(url.datatype){datatype=url.datatype;}
url=url.url;}
if(!url){return;}
if(url){if(!datatype){datatype='json';}
let requestId=bbn.fn.getRequestId(url,data,datatype);let loaderObj=bbn.fn.getLoader(requestId);if(loaderObj&&loaderObj.loader){return loaderObj.loader;}
if(bbn.env.token){bbn.fn.extend(data||{},{_bbn_token:bbn.env.token});}
let cancelToken=axios.CancelToken;let source=cancelToken.source();let options={responseType:datatype,cancelToken:source.token};if(datatype==='text'){options.headers={accept:'text/javascript','Content-Type':'text/javascript'};}
let args=[url];if(bbn.fn.isObject(data)&&(bbn.fn.numProperties(data)>0)){args.push(data);}
args.push(options);let loader=axios[args.length===2?'get':'post'].apply(axios,args).then((res)=>{bbn.fn._deleteLoader(requestId,res);bbn.fn.defaultEndLoadingFunction(url,tst,data,res);switch(res.status){case 200:if(bbn.fn.isFunction(success)){success(res.data,res.headers);}
break;default:bbn.fn.defaultAjaxErrorFunction(loader,res)}
return res;}).catch((err)=>{let isAbort=axios.isCancel(err);bbn.fn._deleteLoader(requestId,err.message||err.response.data,isAbort);bbn.fn.defaultEndLoadingFunction(url,tst,data,err);if(isAbort){let ok=1;if(bbn.fn.isFunction(abort)){ok=abort(err.message,url);}
if(ok){bbn.fn.defaultAjaxAbortFunction(err.message,url);}}
else{let ok=1;if(bbn.fn.isFunction(failure)){ok=failure(err.request,err);}
if(ok){bbn.fn.defaultAjaxErrorFunction(err.request,err.response?err.response.data:'',err.response?err.response.status:err);}}});let tst=bbn.fn._addLoader(requestId,loader,source);bbn.fn.defaultStartLoadingFunction(url,tst,data,requestId);return loader;}},treatAjaxArguments(args){let cfg={},t,i;if(bbn.fn.isObject(args[0])&&(args.length===1)){return args[0];}
for(i=0;i<args.length;i++){t=typeof(args[i])
t=t.toLowerCase();if(bbn.fn.isFunction(args[i])){if(cfg.errorFn&&!cfg.abortFn){cfg.abortFn=args[i];}
if(cfg.successFn&&!cfg.errorFn){cfg.errorFn=args[i];}
else if(!cfg.successFn){cfg.successFn=args[i];}}
else if((args[i]===1)||(args[i]===true)){cfg.force=true;}
else if(t==='string'){if(!cfg.url){if(args[i].indexOf('#')===0||args[i].indexOf(bbn.env.root+'#')===0){cfg.url=bbn.fn.substr(args[i],bbn.env.root.length);}
else{cfg.url=args[i];if(cfg.url.indexOf(bbn.env.root)===0){cfg.url=bbn.fn.substr(cfg.url,bbn.env.root.length);}}}
else{cfg.datatype=args[i];}}
else if(t.toLowerCase()==='object'){if((args[i].type!==undefined)&&(args[i].target!==undefined)&&(args[i].preventDefault!==undefined)){cfg.e=args[i];}
else if(!cfg.ele&&(args[i].nodeType===1)){cfg.ele=args[i];}
else if(t.toLowerCase()==='object'){cfg.obj=args[i];}}}
if(!cfg.url&&bbn.fn.numProperties(cfg)){cfg.url=bbn.env.path;}
if(cfg.obj===undefined){cfg.obj={_bbn:"public"};}
if(!cfg.datatype){cfg.datatype="json";}
return cfg;},post(){let cfg=bbn.fn.treatAjaxArguments(arguments);if(cfg.url){return bbn.fn.ajax(cfg.url,cfg.datatype,cfg.obj,(res)=>{bbn.fn.callback(cfg.url,res,cfg.successFn,false,cfg.ele);},cfg.errorFn,cfg.abortFn);}},link(){let cfg=bbn.fn.treatAjaxArguments(arguments),ok=1;if(cfg===true){return true;}
if(!cfg){return bbn.fn.link(window.location.href);}
if(cfg.url.indexOf('javascript:')===0){return true;}
if(cfg.url.indexOf('data:')===0){return true;}
if(cfg.url.indexOf('#')===0){location.href=bbn.env.url+cfg.url;return true;}
else if(cfg.url.indexOf('mailto:')===0){bbn.env.ignoreUnload=true;window.location.href=cfg.url;setTimeout(()=>{bbn.env.ignoreUnload=false;},0)
return false;}
if(bbn.fn.getLoader(cfg.url)){return false;}
if(((cfg.url.indexOf("http://")===0)||(cfg.url.indexOf("https://")===0))&&(cfg.url.indexOf(bbn.env.host)!==0)){if(cfg.e){cfg.e.preventDefault();}
window.open(cfg.url);return false;}
else if((cfg.url!==bbn.env.params.join("/"))||(cfg.force===1)){if(cfg.successFn){ok=cfg.successFn(cfg.url);}
else if(bbn.fn.defaultPreLinkFunction){ok=bbn.fn.defaultPreLinkFunction(cfg.url,cfg.force,cfg.ele);if(ok.data!==undefined){bbn.fn.extend(cfg.obj,ok.data);ok=1;}}
if(ok){if(ok!==1&&(typeof ok==='string')){cfg.url=ok;}
let errSt=bbn._("The Ajax call to")+' '+cfg.url+' ';return bbn.fn.ajax(cfg.url,cfg.datatype,cfg.obj,function(res){if(!res){bbn.fn.log(errSt+bbn._("returned no answer"));}
if(bbn.fn.isObject(res)){if((Object.keys(res).length===0)){bbn.fn.log(errSt+bbn._("returned an empty object"));}
if(res.new_url){res.old_path=cfg.url;cfg.url=res.new_url;}
else if(res.url&&(cfg.url!==res.url)){res.old_path=cfg.url;}}
if(bbn.fn.callback(cfg.url,res,cfg.successFn,null,cfg.ele)&&res.noNav===undefined){if(bbn.env.path.indexOf(cfg.url)!==0){bbn.fn.setNavigationVars(cfg.url,(res.title?res.title+' - ':'')+bbn.env.siteTitle);}}},cfg.errorFn||null);}}
return true;},callback(url,res,fn,fn2,ele){let tmp=false;if(res){tmp=true;let t=typeof res;let isObj=t.toLowerCase()==='object';let errTitle;if(isObj&&res.prescript){try{eval(res.prescript);}
catch(e){bbn.fn.error(e.message||'')}}
if(isObj&&res.url===undefined){res.url=url;}
if(fn){tmp=fn(res,ele);}
else{tmp=bbn.fn.defaultLinkFunction(res,ele);}
if(ele&&isObj&&(res.content!==undefined)){if(ele.is("input,textarea")){ele.val(res.content);}
else{bbn.fn.insertContent(res.content,ele);}}
if(tmp&&isObj&&res.script){if(bbn.fn.isFunction(res.script)){tmp=res.script(res.data?res.data:{},ele?ele:false);}
else{tmp=((data,ele)=>{let r=null;try{r=eval(res.script)(data,ele);}
catch(e){bbn.fn.error(e.getMessage());}
return r;})(res.data?res.data:{},ele?ele:false);}}
if(tmp&&fn2){fn2(res);}
else if(isObj&&bbn.fn.defaultPostLinkFunction){bbn.fn.defaultPostLinkFunction(res,ele);}
if(tmp&&isObj&&res.postscript){eval(res.postscript);}
if(isObj&&res.error){errTitle=res.errorTitle||bbn.lng.server_response;bbn.fn.defaultAlertFunction(res.error,errTitle);}}
else{bbn.fn.defaultAlertFunction(bbn.lng.errorText,bbn.lng.error);}
return tmp;},setNavigationVars(url,title,data,repl){bbn.env.old_path=bbn.env.path;bbn.env.url=['https:/','http://'].includes(bbn.fn.substr(url,0,7))?url:bbn.env.root+url;bbn.env.path=bbn.fn.substr(bbn.env.url,bbn.env.root.length);bbn.env.params=bbn.fn.filter(bbn.env.path.split("/"),(v)=>{return v!=='';});let h=window.history;if(h){let state=h.state;let obj={url:bbn.env.path,old_path:bbn.env.old_path||null,data:data||{}};if(state&&(state.url===bbn.env.path)){if(state.data){bbn.fn.extend(obj.data,state.data);}
if(state.title&&!title){title=state.title;}
repl=1;}
if(!title){title=bbn.env.siteTitle;}
else{title=bbn.fn.html2text(title);}
if(repl){obj.reload=1;h.replaceState(obj,title,bbn.env.url);}
else{h.pushState(obj,title,bbn.env.url);}}},postOut(url,data,success,target){let form=document.getElementById("bbn-form_out");if(!form){form=document.createElement('form');form.classList.add('bbn-no');form.setAttribute('id','bbn-form_out');form.setAttribute('method','post');form.setAttribute('enctype','multipart/form-data-encoded');form.style.display='none';document.body.appendChild(form);}
form.innerHTML='';form.setAttribute('action',url);form.setAttribute('target',target||"_blank");if(!data){data={};}
data=bbn.fn.extend({},data,true);if(!data.bbn){data.bbn='public';}
bbn.fn.addInputs(form,data);form.submit();if(success){success();}},abort(requestId){let loader=bbn.fn.getLoader(requestId);if(loader&&loader.source){loader.source.cancel('Operation canceled by the user.');}},abortURL(url){bbn.fn.each(bbn.fn.filter(bbn.env.loaders,{url:url}),a=>{if(a&&a.source){a.source.cancel('Operation canceled by the user.');}
else{throw new Error("Impossible to find the loader with URL "+url);}});},downloadContent(filename,content,type){if(bbn.fn.isCanvas(content)){content.toBlob((blob)=>{let a=document.createElement('a');a.download=filename;a.href=window.URL.createObjectURL(blob);a.className='bbn-no';a.click();window.URL.revokeObjectURL(a.href);},type||'image/png');return;}
if(!type){type=bbn.fn.isObject(content)&&content.type?content.type:'octet/stream';}
else if(type.indexOf('/')===-1){type='text/'+type;}
let a=window.document.createElement('a');a.className='bbn-no';let src=null;if(bbn.fn.isString(content)){src=new Blob([content],{type:type})}
else{try{src=content;}
catch(e){bbn.fn.log(e);}}
a.href=window.URL.createObjectURL(src);a.download=filename;document.body.appendChild(a);a.click();window.URL.revokeObjectURL(a.href);document.body.removeChild(a);},download(url,filename,params){bbn.fn.log("DOWNLOAD",arguments);if(bbn.fn.isObject(filename)){params=filename;filename=null;}
return bbn.fn.ajax(url,'blob',params||{_bbn_download:1},(d,headers)=>{if(!filename){let cd='attachment; filename=';if(headers&&headers['content-disposition']&&(headers['content-disposition'].indexOf(cd)===0)){filename=bbn.fn.substr(headers['content-disposition'],cd.length+1,headers['content-disposition'].length-cd.length-2);}
else{filename=bbn.fn.baseName(url)}}
if(bbn.fn.isBlob(d)){let extension=bbn.fn.fileExt(filename);let htmlExtensions=['php','html'];if((d.type!=='text/html')||htmlExtensions.includes(extension)){bbn.fn.downloadContent(filename,d);return;}}
bbn.fn.defaultAjaxErrorFunction(e)},e=>{bbn.fn.defaultAjaxErrorFunction(e)});},upload(url,file,success,failure,progress){let fn=()=>{return axios.post(url||bbn.env.path,bbn.fn.objectToFormData(file),{headers:{'Content-Type':'multipart/form-data'},onUploadProgress(progressEvent){if(progress){let percentCompleted=Math.round((progressEvent.loaded*100)/ progressEvent.total)
progress(percentCompleted,progressEvent.loaded,progressEvent.total);}}});};if(!success&&!failure){return fn();}
else{return fn().then(res=>{if(success){bbn.fn.log("SUCCESS",res);success(res);}}).catch(err=>{if(failure){bbn.fn.log("ERROR",err);failure(err)}});}},getLoader(requestId){let idx=bbn.fn.search(bbn.env.loaders,{key:requestId});if(idx>-1){return bbn.env.loaders[idx];}
return false;},getRequestId(url,data,datatype){let d={};if(data){bbn.fn.iterate(data,(a,n)=>{if(n.indexOf('_bbn')===-1){d[n]=a;}})}
return url+':'+bbn.fn.md5((datatype||'json')+JSON.stringify(d));},_addLoader(requestId,prom,source){let tst=(new Date()).getTime();let url=bbn.fn.substr(requestId,0,requestId.length-33);let loader={key:requestId,url:url,loader:prom,source:source,start:tst};bbn.env.loaders.push(loader);bbn.env.loadersHistory.unshift({key:requestId,url:url,loading:true,start:tst,error:false,abort:false,errorMessage:false,success:false});let idx=bbn.env.loadersHistory.length;while(idx&&(bbn.env.loadersHistory.length>bbn.env.maxLoadersHistory)){idx--;if(!bbn.env.loadersHistory.loading){bbn.env.loadersHistory.splice(idx,1);}}
return tst;},_deleteLoader(requestId,res,isAbort){let idx=bbn.fn.search(bbn.env.loaders,{key:requestId});if(idx>-1){let loader=bbn.env.loaders.splice(idx,1)[0];let history=bbn.fn.getRow(bbn.env.loadersHistory,{key:requestId,start:loader.start});if(history){history.loading=false;history.duration=(new Date()).getTime()-loader.start;if(typeof res==='string'){history.errorMessage=res;history.error=!isAbort;history.abort=isAbort;}
else if(bbn.fn.isObject(res)){history.success=true;}}
return true;}
return false;},});})(bbn);;((bbn)=>{"use strict";let _private={};Object.assign(bbn.fn,{addInputs(form,params,prefix){if(form&&(form.tagName==='FORM')){let appendToForm=(name,val)=>{let input=document.createElement('input');input.setAttribute('type','hidden');input.setAttribute('name',name);input.setAttribute('value',val);form.appendChild(input);};params=JSON.parse(JSON.stringify(params||{}));prefix=prefix||'';if(params){bbn.fn.iterate(params,(param,key)=>{let name=prefix?`${prefix}[${key}]`:key;if(param instanceof Date){appendToForm(form,name,param.toISOString());}
else if(param instanceof Array){param.forEach((e,i)=>{const tempName=`${name}[${i}]`;if(typeof e==='object'){bbn.fn.addInputs(form,e,tempName);}
else{appendToForm(tempName,e.toString());}});}
else if((typeof param==='object')&&!(param instanceof File)){bbn.fn.addInputs(form,param,name);}
else{appendToForm(name,param.toString());}});}}},submit(form,e,fn){let url=form.getAttribute("action")||bbn.env.path,data;if(url===''){url='.';}
if((typeof(url)==='string')&&(url.indexOf("http")!==0||url.indexOf(window.document.location.hostname)!==-1)&&!form.getAttribute("target")){if(e){e.preventDefault();}
data=bbn.fn.formdata(form);if(data){form.setAttribute('action',null);form.dataset.bbnSubmit=1;let script=form.dataset.script;if(bbn.fn.isFunction(script)){form.dataset.script=d=>{form.setAttribute("action",url);script(d);};}
if(!fn){fn=form.getAttribute("data-script");}
if(fn){if(bbn.fn.isString(fn)){fn=eval(fn);}
bbn.fn.post(url,data,fn);}
else{bbn.fn.post(url,data);}}}},fieldValue(field){let v;if(field.type==="checkbox"){if(field.checked){v=field.value;if(!v){v=1;}}
else{v=0;}}
else if(field.type==="radio"){if(field.checked){v=field.value;}}
else{v=field.value;}
return v;},formdata(form){let $inputs=form.querySelectorAll('input[name],select[name],textarea[name],button[name]');let res={};let n;let v;bbn.fn.each($inputs,(input,i)=>{v=bbn.fn.fieldValue(input);if((v!==undefined)&&!input.disabled){let name=input.name;if((name.indexOf("[]")===-1)&&(name.indexOf("[")>-1)&&(name.indexOf("]")>-1)&&(name.lastIndexOf("]")===name.length-1)){name=bbn.fn.replaceAll("][",".",name);name=bbn.fn.replaceAll("[",".",name);name=bbn.fn.replaceAll("]","",name);}
if((name.length>2)&&(name.indexOf("[]")===(name.length-2))){n=bbn.fn.substr(name,0,name.length-2);if(res[n]===undefined){res[n]=[];}
res[n].push(v);}
else if(name.indexOf(".")>-1){let tmp,parts=name.split(".");tmp=res;for(let i=0;i<parts.length;i++){if(res[parts[i]]===undefined){if(i<(parts.length-1)){tmp[parts[i]]={};}
else{tmp[parts[i]]=v;}}
tmp=tmp[parts[i]];}}
else{res[name]=v;}}});return res;},objectToFormData(obj,key,ignoreList){let formData=new FormData();let appendFormData=(data,key='')=>{if(!ignoreList||(bbn.fn.isArray(ignoreList)&&!ignoreList.includes(key))){if(data instanceof File){formData.append(key,data);}
else if(bbn.fn.isArray(data)){bbn.fn.each(data,(v,i)=>{appendFormData(v,key+'['+i+']');})}
else if(bbn.fn.isObject(data)&&Object.keys(data).length){bbn.fn.iterate(data,(v,i)=>{if(data.hasOwnProperty(i)){appendFormData(v,!key?i:key+'['+i+']');}})}
else{if(!bbn.fn.isNull(data)&&(data!==undefined)){formData.append(key,data);}}}}
appendFormData(obj,key);return formData;},});})(bbn);;((bbn)=>{"use strict";let _private={};Object.assign(bbn.fn,{history(){return window.history||false;},});})(bbn);;((bbn)=>{"use strict";let _private={};Object.assign(bbn.fn,{init(cfg,force){let parts;if(!bbn.env.isInit||force){bbn.env.root=document.baseURI.length>0?document.baseURI:bbn.env.host;if(bbn.env.root.length&&(bbn.fn.substr(bbn.env.root,-1)!=='/')){bbn.env.root+='/';}
if(!bbn.env.isInit&&(typeof dayjs!=='undefined')){bbn.fn.each(['advancedFormat','arraySupport','badMutable','buddhistEra','calendar','customParseFormat','dayOfYear','devHelper','duration','isBetween','isLeapYear','isSameOrAfter','isSameOrBefore','isToday','isTomorrow','isYesterday','isoWeek','isoWeeksInYear','localeData','localizedFormat','minMax','objectSupport','pluralGetSet','quarterOfYear','relativeTime','timezone','toArray','toObject','updateLocale','utc','weekOfYear','weekYear','weekday'],plugin=>{if(window['dayjs_plugin_'+plugin]){dayjs.extend(window['dayjs_plugin_'+plugin]);}});}
if(typeof(cfg)==='object'){bbn.fn.extend(true,window.bbn,cfg);}
bbn.env.path=bbn.fn.substr(bbn.env.url,bbn.env.root.length);parts=bbn.env.path.split("/");bbn.fn.each(parts,(v,i)=>{v=decodeURI(v.trim());if(v!==""){bbn.env.params.push(v);}});if(bbn.var.colors){bbn.fn.addColors(bbn.var.colors);}
if(bbn.env.lang&&(undefined!==dayjs)){dayjs.locale(bbn.env.lang);}
window.onfocus=()=>{bbn.env.isFocused=true;};window.onblur=()=>{bbn.env.isFocused=false;bbn.env.timeoff=Math.round((new Date()).getTime()/ 1000);};document.addEventListener("focusin",e=>{if(!e.target.classList.contains('bbn-no')){bbn.env.focused=e.target;}
bbn.env.last_focus=(new Date()).getTime();});document.addEventListener('click',(e)=>{bbn.env.last_focus=(new Date()).getTime();if(bbn.env.nav!=='ajax'){return;}
let target=e.target;if(target.tagName!=='A'){let p=target;while(p&&(p.tagName!=='A')){if(p.tagName==='BODY'){break;}
p=p.parentNode;}
if(p&&(p.tagName==='A')){target=p;}
else{target=false;}}
if(target&&target.href&&!target.target&&!target.classList.contains('bbn-no')){e.preventDefault();e.stopPropagation();bbn.fn.link(target.href);return false;}});bbn.fn.each(document.querySelectorAll("form:not(.bbn-no), form:not(.bbn-form)"),(ele,i)=>{ele.addEventListener("submit",e=>{bbn.fn.submit(ele,e);})});window.addEventListener('hashchange',()=>{bbn.env.hashChanged=(new Date()).getTime();},false);window.addEventListener("resize",()=>{bbn.fn.resize();});window.addEventListener("orientationchange",()=>{bbn.fn.resize();});bbn.fn.resize();if(window.history){window.onpopstate=function(e){let h=window.history;if(!bbn.env.historyDisabled&&h){let state=h.state;if(state){if(bbn.fn.defaultHistoryFunction(state)){bbn.fn.link(state.url,bbn.fn.extend({title:state.title||bbn.env.siteTitle},state.data||{}));}
else if(state&&state.data&&bbn.fn.isFunction(state.data.script)){state.data.script();}}}};}
bbn.env.isInit=true;}},});})(bbn);;((bbn)=>{"use strict";let _private={};Object.assign(bbn.fn,{money(val,kilo,currency,novalue,decimal,thousands,precision){if(!decimal){decimal=(decimal===undefined)&&bbn.env.money&&(bbn.env.money.decimal!==undefined)?bbn.env.money.decimal:'.'}
if(!currency){currency=(currency===undefined)&&bbn.env.money&&(bbn.env.money.currency!==undefined)?bbn.env.money.currency:''}
if(!thousands){thousands=(thousands===undefined)&&bbn.env.money&&(bbn.env.money.thousands!==undefined)?bbn.env.money.thousands:' '}
if(!precision){precision=(precision===undefined)&&bbn.env.money&&(bbn.env.money.precision!==undefined)?bbn.env.money.precision:false}
if(!kilo){kilo=(kilo===undefined)&&bbn.env.money&&(bbn.env.money.kilo!==undefined)?bbn.env.money.kilo:false;}
if(!novalue){novalue=(novalue===undefined)&&bbn.env.money&&(bbn.env.money.novalue!==undefined)?bbn.env.money.novalue:false;}
if(!bbn.fn.isNumber(precision)){precision=kilo?3:0;}
if(val===0){let res=val.toFixed(precision).replace('.',decimal);if(currency){res+=' '+(kilo?'K'+currency:currency);}
return res;}
if((isNaN(val)||!val)&&novalue){return novalue;}
if(isNaN(val)||!val){return 0+(currency?(' '+currency):'');}
if(kilo&&val){val=val / 1000;if(currency){currency='K'+currency;}}
let v=parseFloat(val).toFixed(precision);let decimalPosition=0;let decimalIdx=10000;if(v){decimalIdx=v.indexOf('.');if(decimalIdx<=0){decimalIdx=10000;}
else{decimalPosition=v.length-decimalIdx;}}
return v.replace(/./g,function(c,i,a){if(c==='.'){return decimal;}
return i&&((a.length-i-decimalPosition)%3===0)&&(i<decimalIdx)?thousands+c:c;})+(currency?' '+currency:'');}});})(bbn);;((bbn)=>{"use strict";let _private={};Object.assign(bbn.fn,{checkPropsDetails(obj,props,checkEmpty){let res={error:false,result:true};if(bbn.fn.isString(props)){props=[props];}
if(!bbn.fn.isArray(props)){res.error=bbn._("checkProps must receive a string or an array as props argument");}
if(!bbn.fn.isObject(obj)){res.error=bbn._("checkProps must receive an object as obj argument");}
if(!res.error){let check;bbn.fn.each(props,varName=>{varName=varName.trim().split(':');let type=varName[1]||false;varName=varName[0];if(obj[varName]===undefined){res.error=varName+' '+bbn._("is not defined");}
else if(type){check='is'+bbn.fn.substr(type,0,1).toUpperCase()+bbn.fn.substr(type,1).toLowerCase();if(bbn.fn[check]===undefined){res.error=type+' '+bbn._("is not a valid type");}
else if(!bbn.fn[check](obj[varName])){res.error=varName+' '+bbn._("is not a")+' '+type;}}
else if(checkEmpty&&!obj[varName]){res.error=varName+' '+bbn._("is empty");}
if(res.error){return false;}});}
if(res.error){res.result=false;}
return res;},checkProps(obj,props,checkEmpty){return bbn.fn.checkPropsDetails(obj,props,checkEmpty).result;},checkPropsOrDie(obj,props,checkEmpty){let res=bbn.fn.checkPropsDetails(obj,props,checkEmpty);if(res.error){throw new Error(res.error);}
return true;},translate(o,namespace){let lng=namespace?bbn.lng[namespace.indexOf('_')===0?namespace:'_'+namespace]:bbn.lng;bbn.fn.iterate(o,(v,k)=>{lng[k]=v;});},timestamp(seconds){var r=(new Date()).getTime();return seconds?r*1000:r;},log(...args){if(window.console!==undefined){let cfg,level=5;if(args[0]&&(typeof args[0]==='object')&&args[0]._bbn_console_style){cfg=args[0]._bbn_console_style;level=args[0]._bbn_console_level;args.shift();}
else{cfg="background: #EEE; color: #666; font-size: 12px";}
if(bbn.env.loggingLevel>=level){let i=0;while(i<args.length){let t=typeof args[i];if((t==='string')||(t==='number')){window.console.log("%c %s ",cfg,args[i]);}
else{window.console.log(args[i]);}
i++;}}}
return this;},warning(...args){args.unshift({_bbn_console_level:2,_bbn_console_style:"color: red; background: yellow; font-size: 16px; width: 100%;"});bbn.fn.log.apply(this,args);return this;},error(...args){args.unshift({_bbn_console_level:1,_bbn_console_style:"color: white; background: red; font-size: 22px;"});bbn.fn.log.apply(this,args);return this;},happy(...args){args.unshift({_bbn_console_level:3,_bbn_console_style:"color: white; background: green; font-size: 18px;"});bbn.fn.log.apply(this,args);return this;},info(...args){args.unshift({_bbn_console_level:4,_bbn_console_style:"color: #EEE; background: blue; font-size: 12px;"});bbn.fn.log.apply(this,args);return this;},stat(returnStat){return;if(bbn.env.logging){var logs=bbn.var.loggers;for(var i=0;i<arguments.length;i++){var a=arguments[i],type=typeof(a);if((type==='boolean')||(type==='undefined')){break;}
else{if(type==='object'){a=bbn.fn.getPath(a);}
else{a=a.toString();}
if(!logs[a]){logs[a]={_num:0,};}
logs[a]._num++;logs=logs[a];}}
if(arguments[arguments.length-1]===true){var treat=function(obj){var v={};for(var n in obj){if(n.indexOf('_')!==0){v[n+'('+obj[n]._num+')']=treat(obj[n]);}}
return v;};return treat(logs);}
if(arguments[arguments.length-1]===false){for(var n in logs){delete logs[n];}
logs._num=0;return;}
return returnStat;}},getPath(element){let path,node=element,done=false;while(node.length){let realNode=node,name=realNode.localName;if(!name)break;if(realNode===document.body)break;if(realNode.id){return'#'+realNode.id;}
if(!done){if(realNode.className&&(realNode.className!==' ')){name+=('.'+bbn.fn.replaceAll(" ",".",bbn.fn.replaceAll("  "," ",realNode.className)));}
done=1;}
let parent=node.parentNode,sameTagSiblings=parent.children.filter(val=>{return val.tagName===name;});if(sameTagSiblings.length>1){let allSiblings=parent.children,index=allSiblings.indexOf(realNode)+1;if(index>1){name+=':nth-child('+index+')';}}
path=name+(path?'>'+path:'');node=parent;}
return path;},setCookie(name,value,days){let expires="";if(days){let date=new Date();date.setTime(date.getTime()+(days*24*60*60*1000));expires="; expires="+date.toUTCString();}
let st=escape(JSON.stringify({value:value}));document.cookie=name+"="+st+expires+"; path=/";},getCookie(name){let nameEqual=name+"=";let ca=document.cookie.split(';');for(let i=0;i<ca.length;i++){let c=ca[i];while(c.charAt(0)==' '){c=c.substring(1,c.length);}
if(c.indexOf(nameEqual)==0){let st=c.substring(nameEqual.length,c.length);if(st){return JSON.parse(unescape(st)).value;}}}
return null;},eraseCookie(name){document.cookie=name+'=; Max-Age=-99999999;';},getEventData(e){let dt=e.dataTransfer||e.clipboardData;let t=dt.getData('Text');let res={raw:t,files:[],str:[]};let p=new Promise((ok,err)=>{let done=!(dt instanceof DataTransfer);if(!t&&e.type==='copy'){let sel=window.getSelection();res.raw=sel.toString();let html=bbn.fn.getHTMLOfSelection();res.str.push({type:'text/plain',data:res.raw});if(html!==res.raw){res.str.push({type:'text/html',data:html});}
else if(res.raw.trim().indexOf('<')===0){res.str.push({type:'text/html',data:"<meta charset='utf-8'><code style=\"white-space: pre; font-family: 'Courier New', sans-serif\">\n"+res.raw+"\n</code>"});}
done=true;ok(res);}
if(!done){let strings=[];let num=dt.items.length;bbn.fn.each(dt.items,(item,idx)=>{let kind=item.kind;let type=item.type;if(kind==='file'){let cp=dt.files[idx];if(!type&&cp.name){let bits=cp.name.split('.');type=bits[bits.length-1];}
let name=cp?cp.name:bbn._('untitled');let size=cp?cp.size:null;let lastModified=cp?cp.lastModified:null;let blob=item.getAsFile();if(blob){done=true;num--;res.files.push({type:type,data:blob,name:name,size:size,mdate:lastModified});strings.push(name);if(!num){if(!res.raw){res.raw=strings.join(", ");}
ok(res);}}
else{appui.error(bbn._("Impossible to read the file")+' '+name);}}
else{done=true;item.getAsString((data)=>{num--;res.str.push({type:type,data:data});if(type==='text/plain'){strings.push(name);}
if(!num){if(!res.raw){res.raw=strings.join(", ");}
ok(res);}});}});}
if(!done){setTimeout(()=>{ok(res);});}});return p;},arrayBuffer2String(buf){return String.fromCharCode.apply(null,new Uint16Array(buf));},string2ArrayBuffer(str){var buf=new ArrayBuffer(str.length*2);var bufView=new Uint16Array(buf);for(var i=0,strLen=str.length;i<strLen;i++){bufView[i]=str.charCodeAt(i);}
return buf;},getHTMLOfSelection(){let range;if(document.selection&&document.selection.createRange){bbn.fn.log("METHOD 1");range=document.selection.createRange();return range.htmlText;}
else if(window.getSelection){let selection=window.getSelection();if(selection.rangeCount>0){range=selection.getRangeAt(0);bbn.fn.log("RANGE",range);let clonedSelection=range.cloneContents();bbn.fn.log("clonedSelection",clonedSelection);let div=document.createElement('div');div.appendChild(clonedSelection);return div.innerHTML;}
else{return'';}}
else{return'';}},copy(st){return new Promise(resolve=>{if(st){if(navigator&&navigator.clipboard){if(st instanceof Blob){navigator.clipboard.write([new ClipboardItem({[st.type.toString()]:st})]).then(()=>{resolve();});}
else if(bbn.fn.isObject(st)&&bbn.fn.isFunction(st.toBlob)){st.toBlob(blob=>{navigator.clipboard.write([new ClipboardItem({[blob.type.toString()]:blob})]).then(()=>{resolve();});})}
else{navigator.clipboard.writeText(st);resolve();}
return;}
let input=document.createElement("textarea");input.style.opacity=0;input.value=st;document.body.appendChild(input);input.select();document.execCommand('copy');document.body.removeChild(input);resolve();}
resolve();})},imageToCanvas(img){let canvas=document.createElement("canvas");canvas.width=img.width;canvas.height=img.height;canvas.getContext("2d").drawImage(img,0,0);return canvas;},canvasToImage(canvas){let img=new Image();img.src=canvas.toDataURL("image/png");return img;},imgToBase64(img){let canvas=bbn.fn.imageToCanvas(img);return bbn.fn.canvasToImage(canvas);},isActiveInterface(secs=600){if(!bbn.env.last_focus){return false;}
let t=(new Date()).getTime();return(t-bbn.env.last_focus)<(secs*1000);},formatBytes(bytes,decimals=2){if(!bytes){return'0 B';}
const k=1024,s=['B','KB','MB','GB','TB','PB','EB','ZB','YB'],i=Math.floor(Math.log(bytes)/ Math.log(k));return parseFloat((bytes / Math.pow(k,i)).toFixed(decimals<0?0:decimals))+' '+s[i];},startChrono(name){let now=(new Date()).getTime();let h1=3600*1000;if(_private.length){bbn.fn.each(_private,(t,n)=>{if(now-t>h1){delete _private[n];}});now=(new Date()).getTime();}
_private[name]=now;},stopChrono(name){if(_private[name]){let now=(new Date()).getTime();let diff=now-_private[name];return diff;}},getDeviceType(){const userAgent=navigator.userAgent.toLowerCase();if(/iPhone|Android/i.test(navigator.userAgent)){return"mobile";}
if(/(ipad|tablet|(android(?!.*mobile))|(windows(?!.*phone)(.*touch))|kindle|playbook|silk|(puffin(?!.*(IP|AP|WP))))/.test(userAgent)){return"tablet";}
return"desktop";},isMobileDevice(){return this.getDeviceType()==='mobile';},isTabletDevice(){return this.getDeviceType()==='tablet';},isDesktopDevice(){return this.getDeviceType()==='desktop';},isMobile(){return bbn.fn.isMobileDevice()||bbn.fn.isTabletDevice();},getTimeoff(){if(!bbn.env.isFocused){return Math.round((new Date()).getTime()/1000-bbn.env.timeoff);}
return 0;},isFocused(ele,contain){return(ele===document.activeElement)||(contain&&ele.contains&&(ele.contains(document.activeElement)));},selectElementText(ele,win){win=win||window;if(ele instanceof HTMLInputElement){ele.select();return;}
let doc=win.document;let sel;let range;if(win.getSelection&&doc.createRange){sel=win.getSelection();range=doc.createRange();range.selectNodeContents(ele);sel.removeAllRanges();sel.addRange(range);}
else if(doc.body.createTextRange){range=doc.body.createTextRange();range.moveToElementText(ele);range.select();}},getAncestors(ele,sel){let r=[];if(bbn.fn.isString(ele)){ele=document.querySelector(ele);}
if(ele instanceof HTMLElement){if(typeof(sel)==='string'){while(ele=ele.closest(sel)){r.push(ele);}}
else{if(sel===true){r.push(ele);}
while(ele=ele.parentNode){r.push(ele);}}}
return r;},isInside(ele,ancestor){let ancestors=bbn.fn.getAncestors(ele);if(ancestors.length){if(bbn.fn.isString(ancestor)){ancestor=document.querySelector(ancestor);}
if(ancestor instanceof HTMLElement){return ancestors.indexOf(ancestor)>-1;}}
return false;}});})(bbn);;((bbn)=>{"use strict";let _private={};Object.assign(bbn.fn,{unique(arr){return arr.filter(function(el,index,ar){return index===ar.indexOf(el);});},getProperty(obj,prop){if((typeof obj==='object')&&(typeof prop==='string')){return prop.split('.').reduce((o,i)=>{if(o&&(o[i]!==undefined)){return o[i];}
return undefined;},obj);}},order(arr,prop,dir='asc'){if(arr){return arr.sort(function(a,b){return bbn.fn._compareValues(a,b,prop,dir);});}
return arr;},multiorder(arr,orders){if(!Array.isArray(orders)&&(typeof orders==='object')){let tmp=[];for(var n in orders){tmp.push({field:n,dir:orders[n]});}
orders=tmp;}
let r=arr.slice();return r.sort((a,b)=>{let res;for(let order of orders){res=bbn.fn._compareValues(a,b,order.field,order.dir);if(res!==0){return res;}}
return 0;})},move(arr,fromIndex,toIndex){if(toIndex>=arr.length){let k=toIndex-arr.length;while((k--)+1){arr.push(undefined);}}
arr.splice(toIndex,0,arr.splice(fromIndex,1)[0]);return arr;},compare(v1,v2,operator){switch(operator){case"===":case"=":case"equal":case"eq":case"is":return v1===v2;case"!==":case"notequal":case"neq":case"isnot":return v1!==v2;case"!=":case"different":return v1!=v2;case"contains":case"contain":case"icontains":case"icontain":if(bbn.fn.isEmpty(v1)||bbn.fn.isEmpty(v2)){return false;}
return bbn.fn.removeAccents(v1).toLowerCase().indexOf(bbn.fn.removeAccents(v2).toLowerCase())!==-1;case"doesnotcontain":case"donotcontain":if(bbn.fn.isNull(v1)||bbn.fn.isNull(v2)){return true;}
return bbn.fn.removeAccents(v1.toLowerCase()).indexOf(bbn.fn.removeAccents(v2.toLowerCase()))===-1;case"starts":case"start":if(bbn.fn.isNull(v1)||bbn.fn.isNull(v2)){return false;}
if((typeof(v1)!=='string')){v1=v1.toString()||'';}
if((typeof(v2)!=='string')){v2=v2.toString()||'';}
return v1.indexOf(v2)===0;case"startswith":case"startsi":case"starti":case"istarts":case"istart":if(bbn.fn.isNull(v1)||bbn.fn.isNull(v2)){return false;}
return bbn.fn.removeAccents(v1).toLowerCase().indexOf(bbn.fn.removeAccents(v2).toLowerCase())===0;case"endswith":case"endsi":case"endi":case"iends":case"iend":if(bbn.fn.isNull(v1)||bbn.fn.isNull(v2)){return false;}
return v1.lastIndexOf(v2)===v1.length-v2.length;case"like":if(bbn.fn.isNull(v1)||bbn.fn.isNull(v2)){return false;}
return bbn.fn.removeAccents(v1).toLowerCase()===bbn.fn.removeAccents(v2).toLowerCase();case"gt":case">":return v1>v2;case"gte":case">=":return v1>=v2;case"lt":case"<":return v1<v2;case"lte":case"<=":return v1<=v2;case"isnull":return v1===null;case"isnotnull":return v1!==null;case"isempty":return v1==='';case"isnotempty":return v1!=='';case'==':if(bbn.fn.isObject(v1,v2)){return bbn.fn.isSame(v1,v2);}
default:return v1==v2;}},search(arr,prop,val,operator,startFrom){if(!bbn.fn.isArray(arr)){throw new Error(bbn._("The first argument for a search should be an array")+" "+(typeof arr)+" "+bbn._("given"));}
if(!prop||!arr.length){return-1;}
let filter={};let isFunction=false;if(bbn.fn.isString(prop)){filter[prop]=val;}
else{startFrom=operator;operator=val;if(bbn.fn.isObject(prop)){filter=prop;}
else if(bbn.fn.isFunction(prop)){isFunction=true;filter=prop;}}
if(isFunction||(bbn.fn.isObject(filter)&&bbn.fn.numProperties(filter))){if(bbn.fn.isNumber(operator)){startFrom=operator;operator=undefined;}
if(!bbn.fn.isNumber(startFrom)){startFrom=0;}
if(isFunction){for(let i=startFrom;i<arr.length;i++){if(filter(arr[i])){return i;}}}
else{filter=bbn.fn.filterToConditions(filter);for(let i=startFrom;i<arr.length;i++){if(bbn.fn.compareConditions(arr[i],filter)){return i;}}}}
return-1;},count(arr,prop,val,operator){return bbn.fn.filter(arr,prop,val,operator,false).length||0;},findAll(arr,filter,deepProperty,res=[]){let idx;let start=0;while((idx=bbn.fn.search(arr,filter,start))>-1){res.push(arr[idx]);start=idx+1;}
bbn.fn.each(arr,it=>{if(bbn.fn.isArray(it[deepProperty])){bbn.fn.findAll(it[deepProperty],filter,deepProperty,res);}});return res;},deepPath(arr,filter,deepProperty,res=[]){let idx;let start=0;if((idx=bbn.fn.search(arr,filter,start))>-1){res.push(idx);return res;}
bbn.fn.each(arr,(it,i)=>{if(bbn.fn.isArray(it[deepProperty])){let r=res.slice();r.push(i);let tmp=bbn.fn.deepPath(it[deepProperty],filter,deepProperty,r);if(tmp!==false){return tmp;}}});return false;},sum(arr,numberProp,prop,val,operator){let r=0;let isFunction=bbn.fn.isFunction(numberProp);bbn.fn.each(bbn.fn.filter(arr,prop,val,operator),(a)=>{let tmp=isFunction?numberProp(a):a[numberProp];if(tmp){r+=(parseFloat(tmp)||0);}});return r;},filter(arr,prop,val,operator){if(!bbn.fn.isArray(arr)){throw new Error("Error in bbn.fn.filter: The first argument must be an array");}
var filter={},res=[],isFn=bbn.fn.isFunction(prop),isObj=bbn.fn.isObject(prop);if(!prop||!arr.length){return arr;}
if(arr.length){if(isObj||isFn){operator=val;filter=prop;}
else if(typeof(prop)==='string'){filter[prop]=val;}
else{throw new Error("Search function error: The prop argument should be a string or an object");}
if(isFn){bbn.fn.each(arr,(a,i)=>{if(filter(a,i)){res.push(a);}})}
else{filter=bbn.fn.filterToConditions(filter,operator);if(filter.conditions&&filter.logic){bbn.fn.each(arr,(a)=>{if(bbn.fn.compareConditions(a,filter)){res.push(a);}});}}
return res;}},getRow(arr,prop,val,operator){var idx=bbn.fn.search(arr,prop,val,operator);if(idx>-1){return arr[idx];}
return false;},getField(arr,field,prop,val,operator){var r;if(field&&(r=bbn.fn.getRow(arr,prop,val,operator))){return r[field];}
return undefined;},removePrivateProp(obj,deep){var r=false;if(typeof(obj)==="object"){r={};for(var n in obj){if(bbn.fn.substr(n,0,1).match(/^[A-z0-9]$/)&&obj.hasOwnProperty(n)){if(deep&&(typeof(obj[n])==="object")){r[n]=bbn.fn.removePrivateProp(obj[n],true);}
else{r[n]=obj[n];}}}}
return r;},numProperties(obj){let i=0;if(!obj||(typeof obj!=='object')){return i;}
return Object.keys(bbn.fn.removePrivateProp(obj)).length;},isSame(obj1,obj2){if(obj1===obj2){return true;}
if(obj1&&obj2&&(typeof(obj1)==='object')&&(typeof(obj2)==='object')){let tmp1=Object.keys(bbn.fn.removePrivateProp(obj1)).sort(),tmp2=Object.keys(bbn.fn.removePrivateProp(obj2)).sort();if(JSON.stringify(tmp1)!==JSON.stringify(tmp2)){return false;}
let ok=true;bbn.fn.each(tmp1,a=>{if(bbn.fn.isObject(obj1[a],obj2[a])){if(!bbn.fn.isSame(obj1[a],obj2[a])){ok=false;return false;}}
else if(bbn.fn.numProperties(bbn.fn.diffObj(obj1[a],obj2[a]))){ok=false;return false;}});return ok;}
return false;},filterToConditions(filter,operator){if(!bbn.fn.isObject(filter)){throw new Error("Error in bbn.fn.filterToCondition: filter must be an object");}
if(!filter.conditions||!bbn.fn.isArray(filter.conditions)){let tmp=[];bbn.fn.iterate(filter,(a,n)=>{if(bbn.fn.isObject(a)&&(typeof a.conditions==='object')){tmp.push(bbn.fn.filterToConditions(a));}
else{tmp.push({field:n,operator:operator||'=',value:a});}});filter={conditions:tmp};}
if(!filter.logic){filter.logic='AND';}
return filter;},compareConditions(data,filter){if(!filter.conditions||!filter.logic||!bbn.fn.isArray(filter.conditions)){throw new Error("Error in bbn.fn.compareConditions: the filter should an abject with conditions and logic properties and conditions should be an array of objects");}
let ok=filter.logic==='AND'?true:false;bbn.fn.each(filter.conditions,(a)=>{let compare;if(a.conditions&&bbn.fn.isArray(a.conditions)){compare=bbn.fn.compareConditions(data,a);}
else{compare=bbn.fn.compare(bbn.fn.getProperty(data,a.field),a.value,a.operator);if(compare){let bits=a.field.split('.');let prop=bits.pop();if(bits.length){bbn.fn.each(bits,b=>data=data[b]);}
if(!Object.keys(data).includes(prop)){compare=false;}}}
if(compare){if(filter.logic==='OR'){ok=true;return false;}}
else if(filter.logic==='AND'){ok=false;return false;}});return ok;},extend(){let deep=false;let args=[];for(let i=0;i<arguments.length;i++){if(arguments[i]===true){deep=true;}
else if(!arguments[i]){continue;}
else if(typeof arguments[i]!=='object'){throw new Error(bbn._("Error in bbn.fn.extend: all arguments should be object, you have given ")+typeof(arguments[i]));}
else{args.push(arguments[i]);}}
if(!args.length){throw new Error("No argument given");}
let out=args[0];for(let i=1;i<args.length;i++){bbn.fn.iterate(args[i],(a,key)=>{if(deep){if(bbn.fn.isArray(a)){out[key]=bbn.fn.isArray(out[key])?out[key]:[];bbn.fn.each(a,(b,i)=>{if(b&&(typeof b==='object')){let tmp=out[key][i];if(bbn.fn.isArray(b)){if(!bbn.fn.isArray(tmp)){tmp=[];}}
else if(!bbn.fn.isObject(tmp)){tmp={};}
out[key][i]=bbn.fn.extend(true,tmp,b);}
else{out[key][i]=b;}});}
else if(bbn.fn.isObject(a)){out[key]=bbn.fn.extend(true,out[key]&&(typeof out[key]==='object')?out[key]:{},a);}
else{out[key]=a;}}
else if(out[key]!==a){out[key]=a;}});}
return out;},extendOut(){let r={};for(let i=0;i<arguments.length;i++){if(typeof(arguments[i])!=='object'){throw new Error("Each argument for bbn.fn.extendOut must be an object, "+typeof(arguments[i])+" given");}
if(Array.isArray(arguments[i])){throw new Error("You cannot extend arrays with bbn.fn.extendOut");}
if(i===0){r=arguments[0];}
else{for(let n in arguments[i]){if((typeof(r[n])==='object')&&(typeof(arguments[i][n])==='object')&&!bbn.fn.isFunction(r[n])&&!Array.isArray(r[n])&&!Array.isArray(arguments[i][n])){bbn.fn.extendOut(r[n],arguments[i][n]);}
else if(r[n]===undefined){r[n]=arguments[i][n];}}}}
return r;},autoExtend(namespace,obj){if(!bbn[namespace]){bbn[namespace]={};bbn.fn.extend(bbn[namespace],obj);}
else{bbn.fn.extend(bbn[namespace],obj);}},removeEmpty(arr){var tmp=[];if(bbn.fn.isArray(arr)){for(let i=0;i<arr.length;i++){let ok=false;if(arr[i]){if(bbn.fn.isArray(arr[i])){if(arr[i].length){ok=true;}}
else if(bbn.fn.isObject(arr[i])){if(bbn.fn.numProperties(arr[i])){ok=true;}}
else{ok=true;}}
if(ok){tmp.push(arr[i]);}}}
return tmp;},arrayFromProp(arr,prop){let r=[];bbn.fn.each(arr,(a,i)=>{r.push(bbn.fn.getProperty(a,prop))});return r;},pickValue(arr){if(Array.isArray(arr)&&arr.length){return arr[Math.floor(Math.random()*arr.length)]}},diffObj(obj1,obj2,unchanged,notRoot){let VALUE_CREATED='created',VALUE_UPDATED='updated',VALUE_DELETED='deleted',VALUE_UNCHANGED='unchanged',_compareValues=function(value1,value2){if(value1===value2){return VALUE_UNCHANGED;}
if(bbn.fn.isDate(value1)&&bbn.fn.isDate(value2)&&(value1.getTime()===value2.getTime())){return VALUE_UNCHANGED;}
if('undefined'==typeof(value1)){return VALUE_CREATED;}
if('undefined'==typeof(value2)){return VALUE_DELETED;}
return VALUE_UPDATED;};if(notRoot===undefined){notRoot=false;}
let diff={};if(!bbn.fn.isFunction(obj1)&&!bbn.fn.isFunction(obj1)){if(bbn.fn.isValue(obj1)||bbn.fn.isValue(obj2)){let res=_compareValues(obj1,obj2);if(unchanged||(res!==VALUE_UNCHANGED)){let ret={type:_compareValues(obj1,obj2),data:(obj1===undefined)?obj2:obj1};if(obj1!==undefined){ret.newData=obj2;}
return ret;}
return false;}
for(let key in obj1){if(bbn.fn.isFunction(obj1[key])){continue;}
let value2=undefined;if('undefined'!=typeof(obj2[key])){value2=obj2[key];}
let res=bbn.fn.diffObj(obj1[key],value2,unchanged,true);if(res){diff[key]=res;}}
for(let key in obj2){if(bbn.fn.isFunction(obj2[key])||('undefined'!=typeof(obj1[key]))){continue;}
let res=bbn.fn.diffObj(undefined,obj2[key],unchanged,true);if(res){diff[key]=res;}}}
return!notRoot||unchanged||bbn.fn.numProperties(diff)?diff:false;},fori(arr,fn,max=arr.length-1,min=0){if(bbn.fn.isArray(arr)){let realMax=arr.length-1;if(!bbn.fn.isNumber(max)||!(0<max<=realMax)){max=realMax;}
if(!bbn.fn.isNumber(min)||!(0<=min<realMax)||(min>max)){min=0;}
for(let i=min;i<=max;i++){if(fn(arr[i],i)===false){return;}}}},forir(arr,fn,max=arr.length-1,min=0){if(bbn.fn.isArray(arr)){let realMax=arr.length-1;if(!bbn.fn.isNumber(max)||!(0<max<=realMax)){max=realMax;}
if(!bbn.fn.isNumber(min)||!(0<=min<realMax)||(min>max)){min=0;}
for(let i=max;i>=min;i--){if(fn(arr[i],i)===false){return;}}}},each(arr,fn){if(bbn.fn.isIterable(arr)){for(let i=0;i<arr.length;i++){if(fn(arr[i],i)===false){return;}}
return;}
return bbn.fn.iterate(arr,fn);},iterate(obj,fn,noPrivate){if((obj!==null)&&(typeof obj==='object')){let iter=Object.keys(noPrivate?bbn.fn.removePrivateProp(obj):obj);bbn.fn.each(iter,prop=>{if(fn(obj[prop],prop)===false){return false;}});}
return;},clone(obj){if(bbn.fn.isArray(obj)){return obj.slice().map((a)=>{return typeof(a)==='object'?bbn.fn.clone(a):a;});}
if(bbn.fn.isObject(obj)){return bbn.fn.extend(true,{},obj);}
return obj;},map(arr,fn,deepProp,level=0){return arr.map((a,i)=>{a=fn(a,i,level);if(deepProp&&a[deepProp]&&bbn.fn.isArray(a[deepProp])){a[deepProp]=bbn.fn.map(a[deepProp],fn,deepProp,level+1);}
return a;});},fromXml(xml,arrayTags){let dom=null;if(window.DOMParser)dom=(new DOMParser()).parseFromString(xml,"text/xml");else if(window.ActiveXObject){dom=new ActiveXObject('Microsoft.XMLDOM');dom.async=false;if(!dom.loadXML(xml))throw dom.parseError.reason+" "+dom.parseError.srcText;}
else throw new Error("cannot parse xml string!");function parseNode(xmlNode,result){if(xmlNode.nodeName=="#text"){let v=xmlNode.nodeValue;if(v.trim())result['#text']=v;return;}
let jsonNode={},existing=result[xmlNode.nodeName];if(existing){if(!Array.isArray(existing))result[xmlNode.nodeName]=[existing,jsonNode];else result[xmlNode.nodeName].push(jsonNode);}
else{if(arrayTags&&arrayTags.indexOf(xmlNode.nodeName)!=-1)result[xmlNode.nodeName]=[jsonNode];else result[xmlNode.nodeName]=jsonNode;}
if(xmlNode.attributes)for(let attribute of xmlNode.attributes)jsonNode[attribute.nodeName]=attribute.nodeValue;for(let node of xmlNode.childNodes)parseNode(node,jsonNode);}
let result={};for(let node of dom.childNodes)parseNode(node,result);return result;},toCSV(arr,valSep=',',rowSep=';',valEsc='"'){if(!valSep){valSep=',';}
if(!valEsc){valEsc='"';}
if(!rowSep){rowSep=';';}
let csvContent='';let total=arr.length;bbn.fn.each(arr,(a,i)=>{let num=bbn.fn.isArray(a)?a.length:Object.values(a).length;let j=0;bbn.fn.each(a,(b)=>{if(typeof b==='string'){csvContent+=valEsc+bbn.fn.replaceAll(valEsc,'\\'+valEsc,b)+valEsc;}
else if(b===0){csvContent+='0';}
else if(!b){csvContent+=valEsc+valEsc;}
else{csvContent+=b.toString?b.toString():valEsc+valEsc;}
j++;if(j<num){csvContent+=valSep;}});if(i<total-1){csvContent+=rowSep+"\n";}})
return csvContent;},shortenObj(obj,max=100){let o=bbn.fn.clone(obj);bbn.fn.each(o,(a,n)=>{if(bbn.fn.isString(a)&&(a.length>max)){o[n]=bbn.fn.shorten(a,max);}
else if(a&&(typeof a==='object')){o[n]=bbn.fn.shortenObj(a);}});return o;},_compareValues(a,b,prop,dir='asc'){let va=bbn.fn.getProperty(a,prop),vb=bbn.fn.getProperty(b,prop),ta=(typeof(va)).toLowerCase(),tb=(typeof(vb)).toLowerCase();if((dir!=='asc')&&bbn.fn.isString(dir)&&(dir.toLowerCase()==='desc')){dir='desc';}
if(ta!==tb){va=ta;vb=tb;}
else{switch(ta){case'string':va=bbn.fn.removeAccents(va).toLowerCase();vb=bbn.fn.removeAccents(vb).toLowerCase();break;case'boolean':va=va?1:0;vb=vb?1:0;break;case'object':if(bbn.fn.isDate(va)){va=va.getTime();vb=bbn.fn.isDate(vb)?vb.getTime():0;}
break;}}
if(va<vb){return dir==='desc'?1:-1;}
if(va>vb){return dir==='desc'?-1:1;}
return 0;},});})(bbn);;((bbn)=>{"use strict";let _private={};Object.assign(bbn.fn,{resize(){let diffW=bbn.env.width!==window.innerWidth;let diffH=bbn.env.height!==window.innerHeight;if(diffW||diffH){if(diffW){bbn.env.width=window.innerWidth||window.document.documentElement.clientWidth||window.document.body.clientWidth;document.documentElement.style.setProperty('--vw',(bbn.env.width*0.01)+'px');}
if(diffH){bbn.env.height=window.innerHeight||window.document.documentElement.clientHeight||window.document.body.clientHeight;document.documentElement.style.setProperty('--vh',(bbn.env.height*0.01)+'px');}
let smallWidth=bbn.fn.getCssVar('mobile-limit')||650;let newCls='bbn-screen-'+(bbn.env.width<parseInt(smallWidth)?'small':'regular');let classes=(document.body.className||'').split(' ');let done=false;bbn.fn.each(classes,(cls,idx)=>{let bits=cls.split('-');if((bits.length===3)&&(cls.indexOf('bbn-screen-')===0)){done=true;if(cls!==newCls){classes.splice(idx,1,newCls);}
return false;}});if(!done){classes.push(newCls);}
document.body.className=classes.join(' ');bbn.fn.defaultResizeFunction();}},formatSize(st,noValid){if(bbn.fn.isNumber(st)){return st+'px';}
if(bbn.fn.isString(st)){return st;}
return noValid?false:'auto';},toggleFullScreen(){if(window.document.documentElement.mozRequestFullScreen){if(window.document.mozFullScreen){window.document.mozCancelFullScreen();}
else{window.document.documentElement.mozRequestFullScreen();}}
else if(window.document.documentElement.webkitRequestFullScreen){if(window.document.webkitIsFullScreen){window.document.webkitCancelFullScreen();}
else{window.document.documentElement.webkitRequestFullScreen();}}
else if(window.document.msRequestFullScreen){if(window.document.msFullscreenEnabled){window.document.msExitFullscreen();}
else{window.document.documentElement.msRequestFullScreen();}}
else if(window.document.requestFullscreen){if(window.document.fullscreenEnabled){window.document.exitFullscreen();}
else{window.document.documentElement.requestFullscreen();}}
setTimeout(function(){bbn.fn.resize();},0);},getScrollBarSize(){if(bbn.env.scrollBarSize===undefined){let outer=document.createElement("div");outer.style.visibility="hidden";outer.style.width="100px";outer.style.msOverflowStyle="scrollbar";document.body.appendChild(outer);let widthNoScroll=outer.offsetWidth;outer.style.overflow="scroll";let inner=document.createElement("div");inner.style.width="100%";outer.appendChild(inner);let widthWithScroll=inner.offsetWidth;outer.parentNode.removeChild(outer);let sz=widthNoScroll-widthWithScroll;bbn.env.scrollBarSize=sz?sz+1:0;}
return bbn.env.scrollBarSize;},adjustSize(type,eles){let max=0,idx;bbn.fn.each(eles,(el)=>{el.style[type]='auto';});bbn.fn.each(eles,(el,i)=>{let rect=el.getBoundingClientRect(),s=rect[type]%1?(rect[type]-(rect[type]%1)+1):rect[type];if(s>max){max=s;idx=i;}});bbn.fn.each(eles,(el,i)=>{if(max){el.style[type]=max+'px';}});},adjustHeight(){let args=arguments;if((args.length===1)&&bbn.fn.isIterable(args[0])){args=args[0];}
return bbn.fn.adjustSize('height',args);},adjustWidth(){let args=arguments;if((args.length===1)&&bbn.fn.isIterable(args[0])){args=args[0];}
return bbn.fn.adjustSize('width',args);}});})(bbn);;((bbn)=>{"use strict";let _private={};Object.assign(bbn.fn,{fileExt(filename){if(filename&&bbn.fn.isString(filename)){let bits=filename.split('.');if(bits[0]&&(bits.length>1)){return bits[bits.length-1].toLowerCase();}}
return'';},uniqString(){var st='';for(var i=0;i<arguments.length;i++){if(!arguments[i]){st+='__bbn_empty__';}
else if(typeof(arguments[i])==='object'){if(bbn.fn.isArray(arguments[i])){st+=JSON.stringify(arguments[i]);}
else{let tmp={};let ks=Object.keys(arguments[i]).sort();bbn.fn.each(ks,k=>{tmp[k]=arguments[i][k];});st+=JSON.stringify(tmp);}}
else if(typeof(arguments[i])!=='string'){st+=arguments[i].toString();}
else{st+=arguments[i];}}
return bbn.fn.md5(st);},md5(st){var hc="0123456789abcdef";function rh(n){var j,s="";for(j=0;j<=3;j++)s+=hc.charAt((n>>(j*8+4))&0x0F)+hc.charAt((n>>(j*8))&0x0F);return s;}
function ad(x,y){var l=(x&0xFFFF)+(y&0xFFFF);var m=(x>>16)+(y>>16)+(l>>16);return(m<<16)|(l&0xFFFF);}
function rl(n,c){return(n<<c)|(n>>>(32-c));}
function cm(q,a,b,x,s,t){return ad(rl(ad(ad(a,q),ad(x,t)),s),b);}
function ff(a,b,c,d,x,s,t){return cm((b&c)|((~b)&d),a,b,x,s,t);}
function gg(a,b,c,d,x,s,t){return cm((b&d)|(c&(~d)),a,b,x,s,t);}
function hh(a,b,c,d,x,s,t){return cm(b^c^d,a,b,x,s,t);}
function ii(a,b,c,d,x,s,t){return cm(c^(b|(~d)),a,b,x,s,t);}
function sb(x){var i;var nblk=((x.length+8)>>6)+1;var blks=new Array(nblk*16);for(i=0;i<nblk*16;i++)blks[i]=0;for(i=0;i<x.length;i++)blks[i>>2]|=x.charCodeAt(i)<<((i%4)*8);blks[i>>2]|=0x80<<((i%4)*8);blks[nblk*16-2]=x.length*8;return blks;}
var i,x=sb(st),a=1732584193,b=-271733879,c=-1732584194,d=271733878,olda,oldb,oldc,oldd;for(i=0;i<x.length;i+=16){olda=a;oldb=b;oldc=c;oldd=d;a=ff(a,b,c,d,x[i+0],7,-680876936);d=ff(d,a,b,c,x[i+1],12,-389564586);c=ff(c,d,a,b,x[i+2],17,606105819);b=ff(b,c,d,a,x[i+3],22,-1044525330);a=ff(a,b,c,d,x[i+4],7,-176418897);d=ff(d,a,b,c,x[i+5],12,1200080426);c=ff(c,d,a,b,x[i+6],17,-1473231341);b=ff(b,c,d,a,x[i+7],22,-45705983);a=ff(a,b,c,d,x[i+8],7,1770035416);d=ff(d,a,b,c,x[i+9],12,-1958414417);c=ff(c,d,a,b,x[i+10],17,-42063);b=ff(b,c,d,a,x[i+11],22,-1990404162);a=ff(a,b,c,d,x[i+12],7,1804603682);d=ff(d,a,b,c,x[i+13],12,-40341101);c=ff(c,d,a,b,x[i+14],17,-1502002290);b=ff(b,c,d,a,x[i+15],22,1236535329);a=gg(a,b,c,d,x[i+1],5,-165796510);d=gg(d,a,b,c,x[i+6],9,-1069501632);c=gg(c,d,a,b,x[i+11],14,643717713);b=gg(b,c,d,a,x[i+0],20,-373897302);a=gg(a,b,c,d,x[i+5],5,-701558691);d=gg(d,a,b,c,x[i+10],9,38016083);c=gg(c,d,a,b,x[i+15],14,-660478335);b=gg(b,c,d,a,x[i+4],20,-405537848);a=gg(a,b,c,d,x[i+9],5,568446438);d=gg(d,a,b,c,x[i+14],9,-1019803690);c=gg(c,d,a,b,x[i+3],14,-187363961);b=gg(b,c,d,a,x[i+8],20,1163531501);a=gg(a,b,c,d,x[i+13],5,-1444681467);d=gg(d,a,b,c,x[i+2],9,-51403784);c=gg(c,d,a,b,x[i+7],14,1735328473);b=gg(b,c,d,a,x[i+12],20,-1926607734);a=hh(a,b,c,d,x[i+5],4,-378558);d=hh(d,a,b,c,x[i+8],11,-2022574463);c=hh(c,d,a,b,x[i+11],16,1839030562);b=hh(b,c,d,a,x[i+14],23,-35309556);a=hh(a,b,c,d,x[i+1],4,-1530992060);d=hh(d,a,b,c,x[i+4],11,1272893353);c=hh(c,d,a,b,x[i+7],16,-155497632);b=hh(b,c,d,a,x[i+10],23,-1094730640);a=hh(a,b,c,d,x[i+13],4,681279174);d=hh(d,a,b,c,x[i+0],11,-358537222);c=hh(c,d,a,b,x[i+3],16,-722521979);b=hh(b,c,d,a,x[i+6],23,76029189);a=hh(a,b,c,d,x[i+9],4,-640364487);d=hh(d,a,b,c,x[i+12],11,-421815835);c=hh(c,d,a,b,x[i+15],16,530742520);b=hh(b,c,d,a,x[i+2],23,-995338651);a=ii(a,b,c,d,x[i+0],6,-198630844);d=ii(d,a,b,c,x[i+7],10,1126891415);c=ii(c,d,a,b,x[i+14],15,-1416354905);b=ii(b,c,d,a,x[i+5],21,-57434055);a=ii(a,b,c,d,x[i+12],6,1700485571);d=ii(d,a,b,c,x[i+3],10,-1894986606);c=ii(c,d,a,b,x[i+10],15,-1051523);b=ii(b,c,d,a,x[i+1],21,-2054922799);a=ii(a,b,c,d,x[i+8],6,1873313359);d=ii(d,a,b,c,x[i+15],10,-30611744);c=ii(c,d,a,b,x[i+6],15,-1560198380);b=ii(b,c,d,a,x[i+13],21,1309151649);a=ii(a,b,c,d,x[i+4],6,-145523070);d=ii(d,a,b,c,x[i+11],10,-1120210379);c=ii(c,d,a,b,x[i+2],15,718787259);b=ii(b,c,d,a,x[i+9],21,-343485551);a=ad(a,olda);b=ad(b,oldb);c=ad(c,oldc);d=ad(d,oldd);}
return rh(a)+rh(b)+rh(c)+rh(d);},escapeRegExp(str){return str.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");},roundDecimal(value,decimals){return Number(Math.round(value+'e'+decimals)+'e-'+decimals);},rgb2hex(rgb){rgb=rgb.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i);return(rgb&&rgb.length===4)?"#"+
("0"+parseInt(rgb[1],10).toString(16)).slice(-2)+
("0"+parseInt(rgb[2],10).toString(16)).slice(-2)+
("0"+parseInt(rgb[3],10).toString(16)).slice(-2):'';},hex2rgb(hex){var result=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);return result?{r:parseInt(result[1],16),g:parseInt(result[2],16),b:parseInt(result[3],16)}:null;},camelize(str){return str.replace(/^([A-Z])|[\s-_](\w)/g,function(match,p1,p2,offset){if(p2){return p2.toUpperCase();}
return p1.toLowerCase();});},trim(str,hair=' '){if(hair===' '){return str.trim();}
if(!hair){return str;}
if(hair===str){return'';}
while(str.indexOf(hair)===0){str=bbn.fn.substr(str,hair.length);}
while(str.lastIndexOf(hair)===str.length-hair.length){str=bbn.fn.substr(str,0,str.length-hair.length);}
return str;},sanitize(str,separator='_'){let escaped=['[',']','{','}','(',')','-','+','*','/'];let exp='[';for(let i=0;i<separator.length;i++){if(escaped.includes(separator[i])){exp+='\\';}
exp+=separator[i];}
exp+=']+';let re=new RegExp(exp,'g');let res=bbn.fn.removeAccents(str).replace(/[^a-z0-9]/gi,separator).replace(re,separator);return bbn.fn.trim(res,separator);},camelToCss(str){return str.replace(/([A-Z])/g,function(st){return'-'+st.toLowerCase();}).replace('/^./',function(st){return st.toLowerCase()});},correctCase(str){return str.replace(/[A-z]{1}/,c=>c.toUpperCase());},randomInt(min,max){return Math.floor(Math.random()*(max-min+1)+min);},randomString(min,max,types){let length,type,chars={n:'0123456789',l:'abcdefghijklmnopqrstuvwxyz',u:'ABCDEFGHIJKLMNOPQRSTUVWXYZ'};if(!types){types='nlu';}
if(!min){length=bbn.fn.randomInt(8,14);}
if(bbn.fn.isString(max)){types='n';chars={n:max};if(!length){length=min;}}
else if((typeof(max)==='number')&&(min<max)){length=bbn.fn.randomInt(min,max);}
else if(min){length=min;}
let result='';for(let i=0;i<length;i++){if(i===0){if(types!=='n'){type=types.indexOf('u')===-1?'l':'u';}}
else{type=types[Math.floor(Math.random()*types.length)];}
result+=chars[type][Math.floor(Math.random()*chars[type].length)];}
return result;},shorten(st,len,adj){if(typeof(st).toLowerCase()==='string'){if(!len){len=bbn.var.shortenLen;}
if((adj===undefined)||!bbn.fn.isString(adj)){adj='...';}
if(st.length>len){st=bbn.fn.substr(st,0,len)+adj;}}
return st;},replaceAll(find,replace,str,flags=''){if(str!==undefined){return str.toString().replace(bbn.fn.isObject(find)?find:new RegExp(bbn.fn.escapeRegExp(find),'g'+flags),replace);}
return false;},quotes2html(st,type){if(!type||(type.toLowerCase().indexOf('s')===0)){st=bbn.fn.replaceAll("'","&#39;",st);}
if(!type||(type.toLowerCase().indexOf('d')===0)){st=bbn.fn.replaceAll('"','&quot;',st);}
return st;},nl2br(st){return bbn.fn.replaceAll("\n","<br>",st);},br2nl(st){return bbn.fn.replaceAll("<br />","\n",bbn.fn.replaceAll("<br/>","\n",bbn.fn.replaceAll("<br>","\n",st)));},html2text(st){let $test=document.createElement('div');document.body.appendChild($test);$test.innerHTML=st;st=$test.innerText;document.body.removeChild($test);return st;},removeAccents(st){if(!bbn.fn.isString(st)){if(st.toString){st=st.toString();}
else{bbn.fn.log(st);throw new Error(bbn._("removeAccent expects a string"));}}
return st.normalize('NFD').replace(/[\u0300-\u036f]/g,'');},percent(percent,cent){return(cent/100)*percent;},substr(str,from,length){if(!bbn.fn.isString(str)||!bbn.fn.isInt(from)){bbn.fn.log(arguments);throw new Error(bbn._("The substr function should be applied to a string and at least a `from` argument should be given"));}
if(from<0){from=str.length+from;}
if(!bbn.fn.isInt(length)){return str.substring(from);}
return str.substring(from,(length<0?str.length:from)+length);},escapeUrl(url,params){let st='';if(url.match('^(http|https)://')){st+='http';url=url.substring(4);if(url.substr(0,1)==='s'){st+='s';url=url.substring(1);}
st+='://';url=url.substring(3);}
bbn.fn.each(bbn.fn.dirName(url).split('/'),a=>{st+=encodeURIComponent(a)+'/';});let base=bbn.fn.baseName(url);let sep='?';let existingParams='';if(base.indexOf(sep)){let tmp=base.split('?');sep='&';existingParams='?'+tmp[1];base=tmp[0];}
if(params&&bbn.fn.isString(params)){if(params.match('^(\\&|\\?)')){params=params.substring(1);}
params=sep+params;}
else{params='';}
return st+encodeURIComponent(base)+existingParams+params;},dirName(path){if(bbn.fn.isString(path)&&path){while(bbn.fn.substr(path,path.length-1)==='/'){path=bbn.fn.substr(path,0,path.length-1);}
let pos=path.lastIndexOf('/');if(pos>0){return bbn.fn.substr(path,0,pos);}
if(pos===0){return'/';}}
return'';},baseName(path,suffix){if(path&&bbn.fn.isString(path)){let bits=path.split("/");let res=bits.pop();if(!suffix){return res;}
let len=suffix.length;if(res&&bbn.fn.substr(res,-len)===suffix){return bbn.fn.substr(res,0,res.length-len);}}
return'';},printf(format){var args=Array.prototype.slice.call(arguments,1);return format.replace(/{(\d+)}/g,function(match,number){return typeof args[number]!='undefined'?args[number]:match;});},removeTrailingChars(st,char){if(!char){char=' ';}
if(char.length){while(bbn.fn.substr(st,-char.length)===char){st=bbn.fn.substr(st,0,st.length-char.length);}
while(bbn.fn.substr(st,0,char.length)===char){st=bbn.fn.substr(st,char.length);}}
return st;},repeat(st,num){let res='';bbn.fn.iterate(num,()=>{res+=st;});return res;},removeHtmlComments(st){return st.replace(/<!--[\s\S]*?-->/g,'');},getText(ele){return ele.innerText().trim();},getHtml(ele,stripComments=false){let st=ele.innerHTML();if(stripComments){st=bbn.fn.removeHtmlComments(st);}
return st.trim();}});})(bbn);;((bbn)=>{"use strict";let _private={};Object.assign(bbn.fn,{center(ele){let parent=ele.parentNode,w=parent.clientWidth,h=parent.clientHeight;while(parent&&(!w||!h)){parent=ele.parentNode;w=parent.clientWidth;h=parent.clientHeight;}
bbn.fn.log("BBN_CENTER",w,h);ele.style.position="absolute";ele.style.top=Math.max(0,((h-ele.offsetHeight)/ 2)+parent.scrollTop)+"px";ele.style.left=Math.max(0,((h-ele.offsetWidth)/ 2)+parent.scrollLeft)+"px";return ele;},addColors(colors){let st='';if(bbn.fn.numProperties(colors)){if(!bbn.var.colors){bbn.var.colors={};}
let element=document.createElement('style');document.head.appendChild(element);let sheet=element.sheet;let i=0;bbn.fn.iterate(colors,(v,n)=>{bbn.var.colors[n]=v;sheet.insertRule('.bbn-'+n+', .bbn-color-text-'+n+' {color: '+v+' !important;}',i);sheet.insertRule('.bbn-bg-'+n+', .bbn-color-bg-'+n+', .bbn-color-background-'+n+' {background-color: '+v+' !important;}',i);sheet.insertRule('.bbn-border-'+n+', .bbn-color-border-'+n+' {border-color: '+v+' !important;}',i);sheet.insertRule('.bbn-color-'+n+' {border-color: '+v+'; background-color: '+v+'; color: '+v+';}',i);});}},cssExists(f){var ok,rules,css=document.styleSheets;for(var sx=0;sx<css.length;sx++){ok=1;try{rules=css[sx].rules||css[sx].cssRules;}
catch(e){ok=false;if(e.name!=='SecurityError'){throw e;}}
if(ok){for(var cx=0;cx<rules.length;cx++){if(new RegExp("(^|\\s)"+bbn.fn.escapeRegExp(f)+"(\\{|\\s)","g").test(rules[cx].selectorText)){return true;}}}}
return false;},animateCss(ele,animationName,callback){let animationEnd='webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend';ele.classList.add('animated');ele.classList.add(animationName);ele.addEventListener(animationEnd,(e)=>{e.target.removeEventListener(e.type,arguments.callee);if(typeof callback=='function'){callback.call(this);}
this.classList.remove(animation);});},addStyle(ele,o){if(bbn.fn.isObject(o)){bbn.fn.iterate(o,(v,k)=>{ele.style[k]=v;});}},selector(ele){return(typeof el==='string')?document.querySelector(ele):ele;},outerWidth(ele){ele=bbn.fn.selector(ele);let styles=window.getComputedStyle(ele);let margin=parseFloat(styles['marginLeft'])+
parseFloat(styles['marginRight']);return Math.ceil(ele.offsetWidth+margin);},outerHeight(ele){ele=bbn.fn.selector(ele);let styles=window.getComputedStyle(ele);let margin=parseFloat(styles['marginTop'])+
parseFloat(styles['marginBottom']);return Math.ceil(ele.offsetHeight+margin);},colorToHex(color){let canvas=document.createElement("canvas").getContext("2d");canvas.fillStyle=color;return canvas.fillStyle;},lightenDarkenHex(hex,amt){if(hex&&amt){let ht=hex[0]==="#";hex=ht?hex.slice(1):hex;let num=parseInt(hex,16),r=(num>>16)+amt,b=((num>>8)&0x00FF)+amt,g=(num&0x0000FF)+amt;if(r>255){r=255;}
else if(r<0){r=0;}
if(b>255){b=255;}
else if(b<0){b=0;}
if(g>255){g=255;}
else if(g<0){g=0;}
return(ht?'#':'')+(g|(b<<8)|(r<<16)).toString(16);}},getCssVar(varname){if(varname.indexOf('--')!==0){varname='--'+varname;}
return getComputedStyle(document.documentElement).getPropertyValue(varname);},setCssVar(varname,value){if(varname.indexOf('--')!==0){varname='--'+varname;}
document.documentElement.setProperty(varname,value);}});})(bbn);;((bbn)=>{"use strict";let _private={};Object.assign(bbn.fn,{isEmail(st){if(!bbn.fn.isString(st)){return false;}
let regex=/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/;return regex.test(st);},isColor(st){if(!bbn.fn.isString(st)){return false;}
var reg=new RegExp('^(#[a-f0-9]{6}|#[a-f0-9]{3}|rgb *\( *[0-9]{1,3}%? *, *[0-9]{1,3}%? *, *[0-9]{1,3}%? *\)|rgba *\( *[0-9]{1,3}%? *, *[0-9]{1,3}%? *, *[0-9]{1,3}%? *, *[0-9]{1,3}%? *\)|black|green|silver|gray|olive|white|yellow|maroon|navy|red|blue|purple|teal|fuchsia|aqua)$','i');return reg.test(st);},isIterable(v){return v&&(typeof v==='object')&&(Symbol.iterator in Object(v));},isDimension(st){if((typeof(st)==='number')&&(st>=0)){return true;}
return bbn.fn.isValidDimension(st);},isValidDimension(st){if((typeof(st)==='string')&&(st.length>0)&&((st.indexOf('calc')===0)||(!isNaN(bbn.fn.substr(st,0,1))))){let el=document.createElement('div');el.style.width=st;let res=!!el.style.width.length;el.remove();return res;}
return false;},isEmpty(obj){if(!obj){return true;}
if(bbn.fn.isArray(obj)){return obj.length?false:true;}
if(typeof(obj)==='object'){if(bbn.fn.numProperties(obj)){return false;}
return true;}
return false;},isPromise(){if(!arguments.length)return false;for(let a of arguments){if({}.toString.apply(a)!=='[object Promise]'){return false}}
return true;},isFunction(){if(!arguments.length)return false;for(let a of arguments){if({}.toString.apply(a)!=='[object Function]'){return false}}
return true;},isBlob(){if(!arguments.length)return false;for(let a of arguments){if({}.toString.apply(a)!=='[object Blob]'){return false}}
return true;},isNumber(){if(!arguments.length)return false;for(let a of arguments){if(['boolean','object'].includes(typeof a)||(a==='')||isNaN(a)){return false;}}
return true;},isInt(){if(!arguments.length)return false;for(let a of arguments){if(!Number.isInteger(a)){return false;}}
return true;},isString(){if(!arguments.length)return false;for(let a of arguments){if(typeof a!=='string'){return false}}
return true;},isArray(){if(!arguments.length)return false;for(let a of arguments){if({}.toString.apply(a)!=='[object Array]'){return false}}
return true;},isDate(){if(!arguments.length)return false;for(let a of arguments){if({}.toString.apply(a)!=='[object Date]'){return false}}
return true;},isSQLDate(){if(!arguments.length)return false;for(let a of arguments){if((typeof a!=='string')||!a.match(/^([1-2]\d{3})-((0[0-9])|(1[12]))-(([0-2][0-9])|(3[01]))(?:( [0-2][0-9]):([0-5][0-9]):([0-5][0-9]))?$/)){return false;}}
return true;},isObject(){if(!arguments.length)return false;for(let a of arguments){if({}.toString.apply(a)!=='[object Object]'){return false}}
return true;},isNull(){if(!arguments.length)return false;for(let a of arguments){if({}.toString.apply(a)!=='[object Null]'){return false}}
return true;},isValue(){if(!arguments.length)return false;for(let a of arguments){if((typeof a==='object')&&!bbn.fn.isNull(a)){return false}}
return true;},isDom(){if(!arguments.length)return false;for(let a of arguments){if(!(a instanceof HTMLElement)){return false}}
return true;},isCanvas(){if(!arguments.length)return false;for(let a of arguments){if(!(a instanceof HTMLCanvasElement)){return false}}
return true;},isVue(){if(!arguments.length)return false;for(let a of arguments){if(!(a instanceof Vue)){return false}}
return true;},isPercent(){if(!arguments.length)return false;for(let a of arguments){if((typeof a!=='string')||!a.match(/^\d+(?:\.\d+)?%$/)){return false;}}
return true;},isURL(str){return bbn.var.regexp.url.test(str);},isIP(st){if(bbn.fn.isString(st)){return bbn.var.regexp.ip.test(st);}},isHostname(st){if(bbn.fn.isString(st)){if(bbn.fn.isIP(st)){return true;}
return bbn.var.regexp.hostname.test(st);}}});})(bbn);